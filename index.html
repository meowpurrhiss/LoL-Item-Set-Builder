<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Item Set Builder</title>
<style>
  :root{
    --bg:#0f1720; --card:#111827; --accent:#16a34a; --muted:#9ca3af; --tile:#0b1220;
  }
  html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{background:linear-gradient(180deg,#071023 0%, #071826 100%); color:#e6eef8; display:flex;flex-direction:column;align-items:center;padding:12px;}
  header{width:100%;max-width:980px;margin-bottom:8px}
  h1{font-size:20px;margin:0 0 6px 0;}
  p.lead{margin:0;color:var(--muted);font-size:13px}
  #gridWrap{
    width:100%;
    max-width:980px;
    background:transparent;
    border-radius:10px;
    padding:8px 6px 110px 6px;
    box-sizing:border-box;
  }
  #champGrid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(78px,1fr));
    gap:8px;
    padding:6px;
    align-items:start;
    justify-items:center;
  }
  .champTile{
    width:78px;
    user-select:none;
    text-align:center;
    border-radius:8px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:6px;
    box-sizing:border-box;
    transition:transform .08s ease, box-shadow .12s ease;
    cursor:pointer;
    border:1px solid rgba(255,255,255,0.03);
  }
  .champTile:active{transform:scale(.98)}
  .champTile.selected{outline:3px solid rgba(22,163,74,0.18); box-shadow:0 8px 20px rgba(2,6,23,0.6); transform:translateY(-6px); border-color:rgba(22,163,74,0.45)}
  .champImg{width:60px;height:60px;border-radius:6px;background:#061020;display:block;margin:0 auto 6px auto;object-fit:cover}
  .champName{font-size:11px;color:#e6eef8;line-height:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .controls{
    position:fixed; left:0; right:0; bottom:0;
    background:linear-gradient(180deg, rgba(2,6,23,0.15), rgba(2,6,23,0.95));
    backdrop-filter: blur(6px);
    padding:12px;
    border-top:1px solid rgba(255,255,255,0.03);
    display:flex;
    gap:8px;
    align-items:center;
    justify-content:center;
    z-index:100;
  }
  .btn{padding:12px 16px;border-radius:10px;border:0;background:linear-gradient(180deg,var(--accent),#05944b);color:white;font-weight:600;font-size:14px;box-shadow:0 8px 18px rgba(2,6,23,0.45)}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);font-weight:600}
  
  /* Fixed info box above controls */
  .infoBox{
    position:fixed;
    bottom:70px; /* above controls */
    right:20px;
    width:300px;
    max-height:400px;
    overflow-y:auto;
    padding:12px;
    border-radius:10px;
    background:#111827;
    border:1px solid rgba(255,255,255,0.1);
    color:#e6eef8;
    z-index:200;
    display:none; /* start hidden */
  }
  .resultLine{font-size:14px;color:#e6eef8;margin:6px 0}
  .small{font-size:13px;color:var(--muted)}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}
  @media (min-width:680px){
    .champTile{width:84px}
    .champImg{width:64px;height:64px}
    #champGrid{gap:10px}
    .controls{padding:14px}
  }
</style>
</head>
<body>
<header>
  <h1>Item Set Builder</h1>
  <p class="lead">Tap champion portraits to select the enemy team (max 5). Then tap <strong>Analyze Team</strong> for a composition summary and champion-agnostic item recommendation.</p>
</header>

<div id="gridWrap">
  <div id="champGrid" aria-live="polite"></div>
</div>

<div class="infoBox" id="infoBox">
  <div class="resultLine" id="compSummary"></div>
  <div class="resultLine" id="majorRoles"></div>
  <div class="resultLine" id="buildSuggest" style="font-weight:700"></div>
  <div class="small" id="explain" style="margin-top:6px"></div>
</div>

<div class="controls">
  <button class="btn ghost" id="clearBtn">Clear</button>
  <button class="btn" id="analyzeBtn">Analyze Team</button>
</div>
<script>
const champions = [
  "Aatrox","Ahri","Akali","Akshan","Ambessa","Alistar","Amumu","Anivia","Annie","Aphelios",
  "Ashe","Aurelion Sol","Aurora","Azir","Bard","Bel'Veth","Blitzcrank","Brand","Briar","Braum",
  "Caitlyn","Camille","Cassiopeia","Cho'Gath","Corki","Darius","Diana","Dr. Mundo","Draven","Ekko",
  "Elise","Evelynn","Ezreal","Fiddlesticks","Fiora","Fizz","Galio","Gangplank","Garen","Gnar",
  "Gragas","Graves","Gwen","Hecarim","Heimerdinger","Hwei","Illaoi","Irelia","Ivern","Janna",
  "Jarvan IV","Jax","Jayce","Jhin","Jinx","Kai'Sa","Kalista","Karma","Karthus","Kassadin",
  "Katarina","Kayle","Kayn","Kha'Zix","Kindred","Kled","K’Sante","Kog'Maw","LeBlanc","Lee Sin",
  "Leona","Lillia","Lissandra","Lucian","Lulu","Lux","Malphite","Malzahar","Maokai","Master Yi",
  "Mel","Miss Fortune","Mordekaiser","Morgana","Nami","Nasus","Naafiri","Nautilus","Neeko",
  "Nidalee","Nilah","Nocturne","Nunu & Willump","Olaf","Orianna","Ornn","Pantheon","Poppy","Pyke",
  "Qiyana","Quinn","Rakan","Rammus","Rek'Sai","Rell","Renata Glasc","Renekton","Rengar","Riven",
  "Rumble","Ryze","Samira","Sejuani","Senna","Seraphine","Sett","Shaco","Shen","Shyvana","Singed",
  "Sion","Sivir","Skarner","Smolder","Sona","Soraka","Swain","Sylas","Syndra","Tahm Kench",
  "Taliyah","Talon","Taric","Teemo","Thresh","Tristana","Trundle","Tryndamere","Twisted Fate",
  "Twitch","Udyr","Urgot","Varus","Vayne","Veigar","Vel'Koz","Vex","Vi","Viego","Viktor",
  "Vladimir","Volibear","Warwick","Wukong","Xayah","Xerath","Xin Zhao","Yasuo","Yone","Yorick",
  "Yuumi","Yunara","Zac","Zed","Zeri","Ziggs","Zilean","Zoe","Zyra"
];


const championRoles = {
  "Aatrox":["Tank","ADC/Auto-Attack"],
  "Ahri":["Burst/Assassin","Mage/AP"],
  "Akali":["Burst/Assassin"],
  "Akshan":["ADC/Auto-Attack","Burst/Assassin"],
  "Ambessa":["Burst/Assassin","Mage/AP"],
  "Alistar":["Tank","Healer/Support"],
  "Amumu":["Tank","Mage/AP"],
  "Anivia":["Mage/AP","Poke"],
  "Annie":["Burst/Assassin","Mage/AP"],
  "Aphelios":["ADC/Auto-Attack"],
  "Ashe":["Poke","ADC/Auto-Attack"],
  "Aurelion Sol":["Mage/AP","Poke"],
  "Aurora":["Mage/AP"],
  "Azir":["Mage/AP","ADC/Auto-Attack"],
  "Bard":["Healer/Support"],
  "Bel'Veth":["ADC/Auto-Attack"],
  "Blitzcrank":["Tank","Healer/Support"],
  "Brand":["Mage/AP","Poke"],
  "Briar":["Burst/Assassin"],
  "Braum":["Tank","Healer/Support"],
  "Caitlyn":["ADC/Auto-Attack","Poke"],
  "Camille":["Burst/Assassin","Tank"],
  "Cassiopeia":["Mage/AP","Poke"],
  "Cho'Gath":["Tank","Mage/AP"],
  "Corki":["ADC/Auto-Attack","Mage/AP"],
  "Darius":["Tank","Burst/Assassin"],
  "Diana":["Burst/Assassin","Mage/AP"],
  "Dr. Mundo":["Tank"],
  "Draven":["ADC/Auto-Attack"],
  "Ekko":["Burst/Assassin","Mage/AP"],
  "Elise":["Burst/Assassin","Tank"],
  "Evelynn":["Burst/Assassin"],
  "Ezreal":["ADC/Auto-Attack","Poke"],
  "Fiddlesticks":["Mage/AP","Burst/Assassin"],
  "Fiora":["Burst/Assassin","ADC/Auto-Attack"],
  "Fizz":["Burst/Assassin"],
  "Galio":["Tank","Mage/AP"],
  "Gangplank":["Burst/Assassin","Poke"],
  "Garen":["Tank","ADC/Auto-Attack"],
  "Gnar":["Tank","Burst/Assassin"],
  "Gragas":["Tank","Mage/AP"],
  "Graves":["ADC/Auto-Attack","Burst/Assassin"],
  "Gwen":["Burst/Assassin","ADC/Auto-Attack"],
  "Hecarim":["Tank","Burst/Assassin"],
  "Heimerdinger":["Mage/AP","Poke"],
  "Hwei":["Mage/AP"],
  "Illaoi":["Tank","Burst/Assassin"],
  "Irelia":["Burst/Assassin","ADC/Auto-Attack"],
  "Ivern":["Healer/Support"],
  "Janna":["Healer/Support"],
  "Jarvan IV":["Tank","Burst/Assassin"],
  "Jax":["Burst/Assassin","ADC/Auto-Attack"],
  "Jayce":["Burst/Assassin","Poke"],
  "Jhin":["ADC/Auto-Attack","Poke"],
  "Jinx":["ADC/Auto-Attack"],
  "Kai'Sa":["ADC/Auto-Attack"],
  "Kalista":["ADC/Auto-Attack"],
  "Karma":["Healer/Support","Mage/AP"],
  "Karthus":["Mage/AP","Poke"],
  "Kassadin":["Burst/Assassin","Mage/AP"],
  "Katarina":["Burst/Assassin"],
  "Kayle":["ADC/Auto-Attack","Healer/Support"],
  "Kayn":["Burst/Assassin"],
  "Kha'Zix":["Burst/Assassin"],
  "Kindred":["ADC/Auto-Attack"],
  "Kled":["Tank","Burst/Assassin"],
  "K’Sante":["Tank","Burst/Assassin"],
  "Kog'Maw":["ADC/Auto-Attack"],
  "LeBlanc":["Burst/Assassin","Mage/AP"],
  "Lee Sin":["Burst/Assassin","Tank"],
  "Leona":["Tank","Healer/Support"],
  "Lillia":["Mage/AP","Tank"],
  "Lissandra":["Mage/AP","Poke"],
  "Lucian":["ADC/Auto-Attack"],
  "Lulu":["Healer/Support","Mage/AP"],
  "Lux":["Mage/AP","Poke"],
  "Malphite":["Tank"],
  "Malzahar":["Mage/AP","Poke"],
  "Maokai":["Tank"],
  "Master Yi":["ADC/Auto-Attack","Burst/Assassin"],
  "Mel":["Mage/AP","Healer/Support"],
  "Miss Fortune":["ADC/Auto-Attack","Poke"],
  "Mordekaiser":["Poke","ADC/Auto-Attack"],
  "Morgana":["Healer/Support","Mage/AP"],
  "Nami":["Healer/Support"],
  "Nasus":["Tank","ADC/Auto-Attack"],
  "Naafiri":["Burst/Assassin"],
  "Nautilus":["Tank","Healer/Support"],
  "Neeko":["Mage/AP","Burst/Assassin"],
  "Nidalee":["Burst/Assassin","Poke"],
  "Nilah":["ADC/Auto-Attack"],
  "Nocturne":["Burst/Assassin"],
  "Nunu & Willump":["Tank","Healer/Support"],
  "Olaf":["Tank","Burst/Assassin"],
  "Orianna":["Mage/AP","Poke"],
  "Ornn":["Tank","Mage/AP"],
  "Pantheon":["Burst/Assassin"],
  "Poppy":["Tank","Burst/Assassin"],
  "Pyke":["Burst/Assassin","Healer/Support"],
  "Qiyana":["Burst/Assassin"],
  "Quinn":["ADC/Auto-Attack","Burst/Assassin"],
  "Rakan":["Healer/Support","Tank"],
  "Rammus":["Tank"],
  "Rek'Sai":["Tank","Burst/Assassin"],
  "Rell":["Tank","Healer/Support"],
  "Renata Glasc":["Healer/Support"],
  "Renekton":["Tank","Burst/Assassin"],
  "Rengar":["Burst/Assassin"],
  "Riven":["Burst/Assassin","ADC/Auto-Attack"],
  "Rumble":["Mage/AP","Tank","Poke"],
  "Ryze":["Mage/AP","Poke"],
  "Samira":["ADC/Auto-Attack","Burst/Assassin"],
  "Sejuani":["Tank"],
  "Senna":["ADC/Auto-Attack","Healer/Support"],
  "Seraphine":["Mage/AP","Healer/Support","Poke"],
  "Sett":["Tank","ADC/Auto-Attack"],
  "Shaco":["Burst/Assassin"],
  "Shen":["Tank","Healer/Support"],
  "Shyvana":["Tank","Burst/Assassin"],
  "Singed":["Tank","Poke"],
  "Sion":["Tank"],
  "Sivir":["ADC/Auto-Attack","Poke"],
  "Skarner":["Tank"],
  "Smolder":["ADC/Auto-Attack"],
  "Sona":["Healer/Support","Poke"],
  "Soraka":["Healer/Support"],
  "Swain":["Mage/AP","Poke"],
  "Sylas":["Burst/Assassin","Mage/AP"],
  "Syndra":["Mage/AP","Burst/Assassin"],
  "Tahm Kench":["Tank","Healer/Support"],
  "Taliyah":["Mage/AP","Poke"],
  "Talon":["Burst/Assassin"],
  "Taric":["Healer/Support","Tank"],
  "Teemo":["Poke","Burst/Assassin"],
  "Thresh":["Healer/Support","Tank"],
  "Tristana":["ADC/Auto-Attack"],
  "Trundle":["Tank","ADC/Auto-Attack"],
  "Tryndamere":["ADC/Auto-Attack","Burst/Assassin"],
  "Twisted Fate":["Mage/AP","Poke"],
  "Twitch":["ADC/Auto-Attack","Poke"],
  "Udyr":["Tank","Burst/Assassin"],
  "Urgot":["ADC/Auto-Attack","Tank"],
  "Varus":["ADC/Auto-Attack","Poke"],
  "Vayne":["ADC/Auto-Attack"],
  "Veigar":["Mage/AP","Burst/Assassin"],
  "Vel'Koz":["Mage/AP","Poke"],
  "Vex":["Mage/AP","Burst/Assassin"],
  "Vi":["Burst/Assassin","Tank"],
  "Viego":["Burst/Assassin","ADC/Auto-Attack"],
  "Viktor":["Mage/AP","Poke"],
  "Vladimir":["Mage/AP","Burst/Assassin"],
  "Volibear":["Tank","Burst/Assassin"],
  "Warwick":["Tank","ADC/Auto-Attack"],
  "Wukong":["Burst/Assassin","Tank"],
  "Xayah":["ADC/Auto-Attack"],
  "Xerath":["Mage/AP","Poke"],
  "Xin Zhao":["Tank","Burst/Assassin"],
  "Yasuo":["ADC/Auto-Attack","Burst/Assassin"],
  "Yone":["ADC/Auto-Attack","Burst/Assassin"],
  "Yorick":["ADC/Auto-Attack","Tank"],
  "Yuumi":["Healer/Support"],
  "Yunara":["Burst/Assassin","Mage/AP"],
  "Zac":["Tank","Healer/Support"],
  "Zed":["Burst/Assassin"],
  "Zeri":["ADC/Auto-Attack"],
  "Ziggs":["Mage/AP","Poke"],
  "Zilean":["Healer/Support","Poke"],
  "Zoe":["Mage/AP","Burst/Assassin"],
  "Zyra":["Mage/AP","Poke"]
};

function suggestItemSet(selectedEnemies) {
  const roleCount = { 
    Tank: 0, 
    "Burst/Assassin": 0, 
    "ADC/Auto-Attack": 0, 
    "Mage/AP": 0, 
    "Healer/Support": 0, 
    Poke: 0 
  };
  
  selectedEnemies.forEach(champ => {
    championRoles[champ].forEach(role => {
      if(roleCount[role] !== undefined) roleCount[role]++;
    });
  });
  
  // Determine which role is most common
  const maxCount = Math.max(...Object.values(roleCount));
  const dominantRoles = Object.keys(roleCount).filter(role => roleCount[role] === maxCount);
  
  // Suggest build based on dominant role(s)
  if(dominantRoles.includes("Tank") && dominantRoles.length === 1) return "Anti-Tank";
  if(dominantRoles.includes("Mage/AP") && dominantRoles.length === 1) return "Anti-Mage/AP";
  if(dominantRoles.includes("Burst/Assassin") && dominantRoles.length === 1) return "Anti-Burst";
  if(dominantRoles.includes("ADC/Auto-Attack") && dominantRoles.length === 1) return "Anti-ADC";
  
  // If multiple dominant roles or unclear, return Balanced
  return "Balanced";
}

// keep the toDataDragonKey function from before
function toDataDragonKey(name){
  const special = {
    "Kha'Zix":"KhaZix",
    "Cho'Gath":"ChoGath",
    "Kai'Sa":"Kaisa",
    "LeBlanc":"Leblanc",
    "Nunu & Willump":"Nunu",
    "Dr. Mundo":"DrMundo",
    "Rek'Sai":"RekSai",
    "Vel'Koz":"Velkoz",
    "Jarvan IV":"JarvanIV",
    "Renata Glasc":"Renata",
    "Miss Fortune":"MissFortune",
    "Master Yi":"MasterYi",
    "Tahm Kench":"TahmKench",
    "Xin Zhao":"XinZhao",
    "Aurelion Sol":"AurelionSol",
    "Bel'Veth":"Belveth",
    "Wukong":"MonkeyKing" // add Wukong mapping
  };
  if(special[name]) return special[name];
  return name.split(/[\s'&.]+/).map(w=>w.charAt(0).toUpperCase()+w.slice(1).replace(/[^a-zA-Z0-9]/g,"")).join('');
}

// NEW FUNCTION: get image URL for champions, including custom ones
function getChampionImage(champ) {
  // Map champion names to the exact PNG filename
  const fileMap = {
    "K’Sante": "K'Sante",
    "K'Sante": "K'Sante",
    "Cho'Gath": "Cho'Gath",
    "Cho’Gath": "Cho'Gath",
    "Kha'Zix": "Kha'Zix",
    "Kha’Zix": "Kha'Zix",
    "Aurora": "Aurora",
    "Naafiri": "Naafiri",
    "Akshan": "Akshan",
    "Hwei": "Hwei",
    "Briar": "Briar",
    "Mel": "Mel",
    "Smolder": "Smolder",
    "Ambessa": "Ambessa",
    "Yuumi": "Yuumi",
    "Yunara": "Yunara"
  };

  if(fileMap[champ]) return `custom_champs/${fileMap[champ]}.png`;

  return `https://ddragon.leagueoflegends.com/cdn/13.22.1/img/champion/${toDataDragonKey(champ)}.png`;
}

</script>
<script>
const grid = document.getElementById("champGrid");
const infoBox = document.getElementById("infoBox");
const compSummary = document.getElementById("compSummary");
const majorRoles = document.getElementById("majorRoles");
const buildSuggest = document.getElementById("buildSuggest");
const explain = document.getElementById("explain");

let selected = [];

function renderGrid(){
  grid.innerHTML = "";
  champions.forEach(champ=>{
    const tile = document.createElement("div");
    tile.className="champTile";
    tile.innerHTML = `<img class="champImg" src="${getChampionImage(champ)}" alt="${champ}"><div class="champName">${champ}</div>`;

    tile.addEventListener("click",()=>{
      if(selected.includes(champ)){
        selected = selected.filter(c=>c!==champ);
        tile.classList.remove("selected");
      } else {
        if(selected.length>=5){alert("You can only select up to 5 champions."); return;}
        selected.push(champ);
        tile.classList.add("selected");
      }
    });
    grid.appendChild(tile);
  });
}

document.getElementById("clearBtn").addEventListener("click",()=>{
  selected=[];
  renderGrid();
  infoBox.style.display="none";
});

document.getElementById("analyzeBtn").addEventListener("click",()=>{
  if(selected.length===0){alert("Select at least 1 champion"); return;}
  const rolesCount={};
  selected.forEach(champ=>{
    championRoles[champ].forEach(role=>{
      rolesCount[role]=(rolesCount[role]||0)+1;
    });
  });
  const sortedRoles = Object.entries(rolesCount).sort((a,b)=>b[1]-a[1]);
  compSummary.textContent=`Selected Champions: ${selected.join(", ")}`;
  majorRoles.textContent=`Team Roles: ${sortedRoles.map(r=>r[0]).join(", ")}`;
  const suggestedBuild = suggestItemSet(selected);
buildSuggest.textContent = `Recommended Item Focus: ${suggestedBuild}`;
  explain.textContent="This is a simplified role composition and item suggestion based on selected champions.";
  infoBox.style.display="block";
});

renderGrid();
</script>
</body>
</html>
